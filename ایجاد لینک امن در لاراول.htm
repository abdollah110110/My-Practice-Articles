<!DOCTYPE html>
<html lang="fa"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="csrf-token" content="rCLsHRXyUSmoeXmyakpsF4Z7HbFfFTFh350H22aB">

        <meta name="csrf-token" content="rCLsHRXyUSmoeXmyakpsF4Z7HbFfFTFh350H22aB">

        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

        <title>سمعی وب - وب سایت شخصی عبدالله سمعی | نمایش پست</title>

        <link media="all" type="text/css" rel="stylesheet" href="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/bootstrap_002.css">

        <link media="all" type="text/css" rel="stylesheet" href="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/bootstrap.css">

        <link media="all" type="text/css" rel="stylesheet" href="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/bootstrap-submenu-styles.css">

        <link media="all" type="text/css" rel="stylesheet" href="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/bootstrap-select.css">

        <link media="all" type="text/css" rel="stylesheet" href="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/font-awesome.css">

        <link media="all" type="text/css" rel="stylesheet" href="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/admin-style.css">

        <link media="all" type="text/css" rel="stylesheet" href="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/comments-styles.css">

        <link media="all" type="text/css" rel="stylesheet" href="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/vs.css">


        
    </head>
    <body>

        <!-- navbar -->
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a href="http://samaiweb.com/" class="navbar-brand h2" title="" data-toggle="tooltip" data-original-title="وب سایت شخصی عبدالله سمعی">
                        <img src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/logo.png">سمعی وب</a>
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul id="navbar-nav" class="nav navbar-nav">
                        <li class="">
                            <a href="http://samaiweb.com/admin">صفحه اصلی</a>
                        </li>
                                                <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">امکانات مدیریت <span class="fa fa-caret-down"></span></a>
                            <ul class="dropdown-menu">
                                <li><a href="http://samaiweb.com/categories">موضوعات</a></li>
                                <li><a href="http://samaiweb.com/posts">پست ها</a></li>
                                <li><a href="http://samaiweb.com/comments">نظرات</a></li>
                                <li><a href="http://samaiweb.com/tags">برچسب ها</a></li>
                                <li><a href="http://samaiweb.com/abouts">درباره ما</a></li>
                                <li><a href="http://samaiweb.com/admin/create" target="_blank">ایجاد فایل پشتیبان</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="http://samaiweb.com/logout">خروج</a>
                        </li>
                                            </ul>
                </div><!-- /.navbar-collapse -->
            </div><!-- /.container-fluid -->
        </nav><!-- End of navbar -->

        <div id="content" class="container">
            <div class="row">
                <div class="col-md-12">
                                                <div class="row">
        <div class="col-xs-12">
                        <div id="show-btn-row" class="row">
                <div class="col-xs-12 col-md-4">
                    <a class="btn btn-block btn-lg btn-primary" href="http://samaiweb.com/posts">برگست به صفحه قبل</a>
                </div>
                <div class="col-xs-12 col-md-4">
                    <a class="btn btn-block btn-lg btn-warning" href="http://samaiweb.com/posts/22/edit">ویرایش</a>
                </div>
                <div class="col-xs-12 col-md-4">
                    <form method="POST" action="http://samaiweb.com/posts/22" accept-charset="UTF-8"><input name="_method" value="DELETE" type="hidden"><input name="_token" value="rCLsHRXyUSmoeXmyakpsF4Z7HbFfFTFh350H22aB" type="hidden">
                        <input name="_token" value="rCLsHRXyUSmoeXmyakpsF4Z7HbFfFTFh350H22aB" type="hidden">
                        <button type="submit" class="btn btn-block btn-lg btn-danger" onclick="return confirm('آیا مطمئن هستید؟')">حذف</button>
                    </form>
                </div>
            </div>
            <div class="thumbnail post">
                <h1><span class="fa fa-arrow-left"></span> ایجاد لینک امن در laravel</h1>
                <div class="row alert"><p><span dir="rtl">برای ایجاد لینک امن دانلود یک فایل ابتدا مدل و مایگریشن جدول <code style="background-color:#f8d8f9; color:#fc00cd; padding:0 2px; text-align:center">files</code> را ایجاد میکنیم:</span></p>

<pre><code class=" hljs css"><span class="hljs-tag">php</span> <span class="hljs-tag">artisan</span> <span class="hljs-tag">make</span><span class="hljs-pseudo">:model</span> <span class="hljs-tag">File</span> <span class="hljs-tag">-m</span></code></pre>

<p><span dir="rtl">در مایگریشن ایجاد شده فیلدهای جدول را بصورت زیر تعریف میکنیم:</span></p>

<pre><code class="language-0 hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
{</span>
    Schema::create(<span class="hljs-string">'files'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Blueprint <span class="hljs-variable">$table</span>)</span> {</span>
        <span class="hljs-variable">$table</span>-&gt;increments(<span class="hljs-string">'id'</span>);

        <span class="hljs-variable">$table</span>-&gt;string(<span class="hljs-string">'title'</span>);
        <span class="hljs-variable">$table</span>-&gt;string(<span class="hljs-string">'path'</span>);

        <span class="hljs-variable">$table</span>-&gt;timestamps();
    });
}</code></pre>

<p><span dir="rtl">کنترلر <code style="background-color:#f8d8f9; color:#fc00cd; padding:0 2px; text-align:center">FileController</code> را با دستور زیر ایجاد میکنیم:</span></p>

<pre><code class=" hljs sql">php artisan make:controller FileController <span class="hljs-comment">--model=File</span></code></pre>

<p><span dir="rtl">در فایل web.php روت مورد نیاز این کنترلر را بصورت زیر تعریف میکنیم:</span></p>

<pre><code class="language-0 hljs bash">Route::resource(<span class="hljs-string">'/files'</span>, <span class="hljs-string">'FileController'</span>);</code></pre>

<p><span dir="rtl">در متد create از کنترلر FileController دستورات زیر را قرار میدهیم:</span></p>

<pre><code class="language-0 hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span><span class="hljs-params">()</span>
{</span>
    <span class="hljs-keyword">return</span> view(<span class="hljs-string">'files.create'</span>);
}</code></pre>

<p><span dir="rtl">در فایل views\files\create.blade.php فرم زیر را قرار میدهیم:</span></p>

<pre><code class="language-0 hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">action</span>=<span class="hljs-value">"{{ route('files.store') }}"</span> <span class="hljs-attribute">method</span>=<span class="hljs-value">"POST"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"form-horizontal"</span>&gt;</span>
    {!! csrf_field() !!}
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"form-group {{ $errors-&gt;has('title') ? 'has-error' : '' }}"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"col-md-2 text-left"</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">"title"</span>&gt;</span>عنوان:<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"col-md-6"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"form-control"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"title"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"title"</span> &gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"col-md-4 text-danger"</span>&gt;</span>
            {{ $errors-&gt;first('title') }}
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"form-group {{ $errors-&gt;has('path') ? 'has-error' : '' }}"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"col-md-2 text-left"</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">"path"</span>&gt;</span>مسیر فایل:<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"col-md-6"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"form-control"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"path"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"path"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"col-md-4 text-danger"</span>&gt;</span>
            {{ $errors-&gt;first('path') }}
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"text-center"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-success btn-lg"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"submit"</span>&gt;</span>ایجاد<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span></code></pre>

<p><span dir="rtl">پراپرتی زیر را در مدل File قرار میدهیم:</span></p>

<pre><code class="language-0 hljs cs"><span class="hljs-keyword">protected</span> $fillable = [<span class="hljs-string">'title'</span>, <span class="hljs-string">'path'</span>];</code></pre>

<p><span dir="rtl">در متد store از کنترلر FileController کدهای زیر را قرار میدهیم:</span></p>

<pre><code class="language-0 hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">store</span><span class="hljs-params">(Request <span class="hljs-variable">$request</span>)</span>
{</span>
    <span class="hljs-variable">$this</span>-&gt;validate(<span class="hljs-variable">$request</span>, [
        <span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'required|min:3'</span>,
        <span class="hljs-string">'path'</span> =&gt; <span class="hljs-string">'required'</span>,
    ]);

    <span class="hljs-variable">$file</span> = <span class="hljs-keyword">new</span> File();
    <span class="hljs-variable">$file</span>-&gt;title = <span class="hljs-variable">$request</span>-&gt;title;
    <span class="hljs-variable">$file</span>-&gt;path = <span class="hljs-variable">$request</span>-&gt;path;
    <span class="hljs-variable">$file</span>-&gt;save();

    <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">'/files'</span>);
}</code></pre>

<p><span dir="rtl">سه فایل را در مسیر <code style="background-color:#f8d8f9; color:#fc00cd; padding:0 2px; text-align:center">storage/downloads</code> آپلود میکنیم و توسط متد store عنوان و مسیرشان را بصورت زیر در جدول files ذخیره میکنیم:</span></p>

<pre><code class=" hljs http"><span class="hljs-attribute">title</span>: <span class="hljs-string">24 Forms</span>
<span class="hljs-attribute">path</span>: <span class="hljs-string">downloads\24 Forms.zip</span>
        
<span class="hljs-attribute">title</span>: <span class="hljs-string">25 Forms</span>
<span class="hljs-attribute">path</span>: <span class="hljs-string">downloads\25 Forms.zip</span>
        
<span class="hljs-attribute">title</span>: <span class="hljs-string">26 Forms</span>
<span class="hljs-attribute">path</span>: <span class="hljs-string">downloads\26 Forms.zip</span></code></pre>

<p><span dir="rtl">متد index را در کنترلر FileController بصورت زیر تعریف میکنیم:</span></p>

<pre><code class="language-0 hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span><span class="hljs-params">()</span>
{</span>
    <span class="hljs-variable">$files</span> = File::all();

    <span class="hljs-keyword">return</span> view(<span class="hljs-string">'files.index'</span>, compact(<span class="hljs-string">'files'</span>));
}</code></pre>

<p><span dir="rtl">در فایل views\files\index.blade.php برای ایجاد لینک امن به هر کدام از فایلها باید متد download دز مدل File را فراخوانی کنیم:</span></p>

<pre><code class="language-0 hljs php">@<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>)
&lt;p&gt;
    &lt;a href=<span class="hljs-string">"{{ $file-&gt;download() }}"</span> target=<span class="hljs-string">"_blank"</span>&gt;{{ <span class="hljs-variable">$file</span>-&gt;title }}&lt;/a&gt;
&lt;/p&gt;
@<span class="hljs-keyword">endforeach</span></code></pre>

<p><span dir="rtl">متد <code style="background-color:#f8d8f9; color:#fc00cd; padding:0 2px; text-align:center">download</code> را در مدل File بصورت زیر تعریف میکنیم:</span></p>

<pre><code class="language-0 hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">download</span><span class="hljs-params">()</span> {</span>

    <span class="hljs-variable">$time</span> = Carbon::now()-&gt;addHour(<span class="hljs-number">5</span>)-&gt;timestamp;
    <span class="hljs-variable">$ip</span> = request()-&gt;ip();

    <span class="hljs-variable">$strHash</span> = <span class="hljs-string">'CDE#$RFFVFR%TTGBHYT%%$#@WW#$$'</span> . <span class="hljs-variable">$this</span>-&gt;id . <span class="hljs-variable">$ip</span> . <span class="hljs-variable">$time</span>;

    <span class="hljs-variable">$hash</span> = HasH::make(<span class="hljs-variable">$strHash</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-string">"/download/$this-&gt;id?h=$hash&amp;t=$time"</span>;
}</code></pre>

<p><span dir="rtl">حالا اگر در مرورگر به <code style="background-color:#f8d8f9;color:#fc00cd;padding:0 2px;text-align:center;">http://localhost:8000/files</code> برویم لینکها و همینطور hashهای ساخته شده را بصورت تصویر زیر خواهیم دید:</span></p>

<p><span dir="rtl"><a href="http://samaiweb.com/uploads/images/file-link-hash.jpg" target="_blank"><img alt="تصویر لینکها" src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/file-link-hash.jpg" title="" data-toggle="tooltip" data-original-title="کلیک کنید برای مشاهده تصویر در اندازه واقعی"></a></span></p>

<p><span dir="rtl">روت مربوط به لینکها بصورت زیر خواهد بود:</span></p>

<pre><code class="language-0 hljs coffeescript"><span class="hljs-regexp">//</span> Download Route
<span class="hljs-attribute">Route</span>::get<span class="hljs-function"><span class="hljs-params">(<span class="hljs-string">'/download/{file}'</span>, <span class="hljs-string">'HomeController@download'</span>)</span>-&gt;</span>name(<span class="hljs-string">'download'</span>);</code></pre>

<p><span dir="rtl">در کنترلر HomeController متد <code style="background-color:#f8d8f9; color:#fc00cd; padding:0 2px; text-align:center">download</code> را بصورت زیر تعریف میکنیم:</span></p>

<pre><code class="language-0 hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">download</span><span class="hljs-params">(File <span class="hljs-variable">$file</span>)</span> {</span>

    <span class="hljs-variable">$time</span> = request(<span class="hljs-string">'t'</span>);
    <span class="hljs-variable">$h</span> = request(<span class="hljs-string">'h'</span>);
    <span class="hljs-variable">$ip</span> = request()-&gt;ip();

    <span class="hljs-variable">$strHash</span> = <span class="hljs-string">'CDE#$RFFVFR%TTGBHYT%%$#@WW#$$'</span> . <span class="hljs-variable">$file</span>-&gt;id . <span class="hljs-variable">$ip</span> . <span class="hljs-variable">$time</span>;

    <span class="hljs-keyword">if</span>(Hash::check(<span class="hljs-variable">$strHash</span>, <span class="hljs-variable">$h</span>)){
        <span class="hljs-keyword">return</span> response()-&gt;download(storage_path(<span class="hljs-variable">$file</span>-&gt;path));
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'link error'</span>;
    }
}</code></pre>

<p><span dir="rtl">حالا اگر در <code style="background-color:#f8d8f9;color:#fc00cd;padding:0 2px;text-align:center;">http://localhost:8000/files</code> بر روی لینکها کلیک کنیم دانلود انجام خواهد شد:</span></p>

<p><span dir="rtl"><a href="http://samaiweb.com/uploads/images/link-download.jpg" target="_blank"><img alt="تصویر دانلود امن فایل" src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/link-download.jpg" title="" data-toggle="tooltip" data-original-title="کلیک کنید برای مشاهده تصویر در اندازه واقعی"></a></span></p>
</div>
                                <div id="date-row" class="row">
                    <div class="col-xs-12 col-sm-offset-7 col-sm-5 col-md-offset-8 col-md-4">
                        <div class="text-center post-date">
                            <strong>نوشته شده در تاریخ: </strong>
                            <small>یکشنبه ۱۳۹۶/۱۲/۲۷ - ۰۰:۰۸</small>
                        </div>
                    </div>
                </div>
            </div>
                    </div>
    </div>
                                     </div>
            </div>
        </div><!-- End of container -->

        <script src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/jquery.js"></script>

        <script src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/bootstrap_003.js"></script>

        <script src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/bootstrap_002.js"></script>

        <script src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/bootstrap.js"></script>

        <script src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/bootstrap-select.js"></script>

        <script src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/bootstrap-submenu-script.js"></script>

        <script src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/scripts.js"></script>

        <script src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/show-comment.js"></script>

        <script src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/highlight.js"></script>


         <script type="text/javascript" src="%D8%B3%D9%85%D8%B9%DB%8C%20%D9%88%D8%A8%20-%20%D9%88%D8%A8%20%D8%B3%D8%A7%DB%8C%D8%AA%20%D8%B4%D8%AE%D8%B5%DB%8C%20%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87%20%D8%B3%D9%85%D8%B9%DB%8C%20_%20%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF%20%D9%84%DB%8C%D9%86%DA%A9%20%D8%A7%D9%85%D9%86%20%D8%AF%D8%B1%20laravel_files/show-comment.js"></script>
 
        <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

    

</body></html>